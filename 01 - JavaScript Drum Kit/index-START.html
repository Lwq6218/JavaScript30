<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>JS Drum Kit</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="https://fav.farm/ğŸ”¥" />
  </head>
  <body>
    <div class="keys" sss="sss">
      <div data-key="65" class="key">
        <kbd>A</kbd>
        <span class="sound">clap</span>
      </div>
      <div data-key="83" class="key">
        <kbd>S</kbd>
        <span class="sound">hihat</span>
      </div>
      <div data-key="68" class="key">
        <kbd>D</kbd>
        <span class="sound">kick</span>
      </div>
      <div data-key="70" class="key">
        <kbd>F</kbd>
        <span class="sound">openhat</span>
      </div>
      <div data-key="71" class="key">
        <kbd>G</kbd>
        <span class="sound">boom</span>
      </div>
      <div data-key="72" class="key">
        <kbd>H</kbd>
        <span class="sound">ride</span>
      </div>
      <div data-key="74" class="key">
        <kbd>J</kbd>
        <span class="sound">snare</span>
      </div>
      <div data-key="75" class="key">
        <kbd>K</kbd>
        <span class="sound">tom</span>
      </div>
      <div data-key="76" class="key">
        <kbd>L</kbd>
        <span class="sound">tink</span>
      </div>
    </div>

    <audio data-key="65" src="sounds/clap.wav"></audio>
    <audio data-key="83" src="sounds/hihat.wav"></audio>
    <audio data-key="68" src="sounds/kick.wav"></audio>
    <audio data-key="70" src="sounds/openhat.wav"></audio>
    <audio data-key="71" src="sounds/boom.wav"></audio>
    <audio data-key="72" src="sounds/ride.wav"></audio>
    <audio data-key="74" src="sounds/snare.wav"></audio>
    <audio data-key="75" src="sounds/tom.wav"></audio>
    <audio data-key="76" src="sounds/tink.wav"></audio>

    <script>
      <!-- å¸¸ç”¨äº‹ä»¶ -->
      // click: ç”¨æˆ·ç‚¹å‡»äº†é¼ æ ‡å·¦é”®
      // dblclick: ç”¨æˆ·åŒå‡»äº†é¼ æ ‡å·¦é”®
      // mousedown: ç”¨æˆ·æŒ‰ä¸‹äº†é¼ æ ‡æŒ‰é’®
      // mouseup: ç”¨æˆ·é‡Šæ”¾äº†é¼ æ ‡æŒ‰é’®
      // mousemove: ç”¨æˆ·ç§»åŠ¨äº†é¼ æ ‡
      // mouseover: ç”¨æˆ·å°†é¼ æ ‡ç§»åŠ¨åˆ°å…ƒç´ ä¸Š
      // mouseout: ç”¨æˆ·å°†é¼ æ ‡ä»å…ƒç´ ä¸Šç§»å¼€
      // keydown: ç”¨æˆ·æŒ‰ä¸‹äº†é”®ç›˜çš„é”®
      // keyup: ç”¨æˆ·é‡Šæ”¾äº†é”®ç›˜çš„é”®
      // keypress: ç”¨æˆ·æŒ‰ä¸‹å¹¶é‡Šæ”¾äº†é”®ç›˜çš„é”®
      // load: é¡µé¢å·²å®ŒæˆåŠ è½½
      // unload: é¡µé¢æ­£åœ¨å¸è½½ï¼ˆé€šå¸¸åœ¨å…³é—­é¡µé¢æ—¶ï¼‰
      // focus: å…ƒç´ è·å¾—ç„¦ç‚¹
      // blur: å…ƒç´ å¤±å»ç„¦ç‚¹
      // change: è¡¨å•å…ƒç´ çš„å€¼å·²æ”¹å˜
      // submit: è¡¨å•å·²æäº¤
      // reset: è¡¨å•å·²é‡ç½®
      // resize: çª—å£æˆ–æ¡†æ¶å·²è°ƒæ•´å¤§å°
      // scroll: ç”¨æˆ·æ»šåŠ¨æˆ–å¹³ç§»äº†å…ƒç´ æˆ–é¡µé¢

      function playSound(e) {
        const audio = document.querySelector(`audio[data-key="${e.keyCode}"]`);
        const key = document.querySelector(`.key[data-key="${e.keyCode}"]`);
        if (!audio) return;
        audio.currentTime = 0;
        key.classList.add("playing");
        audio.play();
      }

      // æ–¹æ³•ä¸€:æ¯ä¸ªkeyéƒ½æ·»åŠ ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨
      // function removeTransition(e) {
      //   if (e.propertyName !== "transform") return;
      //   this.classList.remove("playing");
      // }
      // const keys = document.querySelectorAll(".key");
      // keys.forEach((key) =>
      //   key.addEventListener("transitionend", removeTransition)
      // );

      //æ–¹æ³•äºŒ:æ·»åŠ ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨åˆ°keysä¸Š,ç„¶ååˆ¤æ–­e.targetæ˜¯å¦ä¸ºkey
      function removeTransition(e) {
        if (e.propertyName !== "transform") return;
        if (e.target.classList.contains("playing"))
          e.target.classList.remove("playing");
      }
      
      const keys = document.querySelector(".keys");
      keys.addEventListener("transitionend", removeTransition);
      window.addEventListener("keydown", playSound);
      // playSoundå‡½æ•°åœ¨ç”¨æˆ·æŒ‰ä¸‹é”®ç›˜é”®æ—¶è¢«è°ƒç”¨ã€‚å®ƒé¦–å…ˆä½¿ç”¨querySelectoræ–¹æ³•æ‰¾åˆ°ä¸æŒ‰ä¸‹çš„é”®å¯¹åº”çš„audioå…ƒç´ å’Œ.keyå…ƒç´ ã€‚
      // å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„audioå…ƒç´ ï¼Œå‡½æ•°å°±ä¼šè¿”å›ã€‚ç„¶åï¼Œå®ƒå°†audioå…ƒç´ çš„currentTimeå±æ€§è®¾ç½®ä¸º0ï¼Œè¿™æ ·æ¯æ¬¡æŒ‰é”®æ—¶éƒ½ä¼š
      // ä»å¤´å¼€å§‹æ’­æ”¾å£°éŸ³ã€‚æœ€åï¼Œå®ƒç»™.keyå…ƒç´ æ·»åŠ playingç±»ï¼Œå¹¶æ’­æ”¾å£°éŸ³ã€‚
      // removeTransitionå‡½æ•°åœ¨.keyå…ƒç´ çš„CSSè¿‡æ¸¡ç»“æŸæ—¶è¢«è°ƒç”¨ã€‚å¦‚æœè¿‡æ¸¡çš„å±æ€§åä¸æ˜¯transformï¼Œå‡½æ•°å°±ä¼šè¿”å›ã€‚
      //å¦åˆ™ï¼Œå®ƒä¼šä».keyå…ƒç´ ä¸Šç§»é™¤playingç±»ã€‚
      // åœ¨ä»£ç çš„æœ€åï¼ŒaddEventListeneræ–¹æ³•è¢«ç”¨äºæ·»åŠ äº‹ä»¶ç›‘å¬å™¨ã€‚å¯¹äºæ¯ä¸€ä¸ª.keyå…ƒç´ ï¼Œå½“CSSè¿‡æ¸¡ç»“æŸæ—¶ï¼Œ
      //removeTransitionå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚å½“ç”¨æˆ·æŒ‰ä¸‹é”®ç›˜é”®æ—¶ï¼ŒplaySoundå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚
    </script>
  </body>
</html>
